st = `[{"date":"2022-02-04T00:00:00+0000","symbol":"GOOG","volume":2458600,"high":2890.7051,"low":2796.3501,"exchange":"XNAS","close":2860.3201,"open":2860.3401},{"date":"2022-02-03T00:00:00+0000","volume":2829691,"high":2982.3545,"low":2844.1001,"close":2853.01,"open":2905.8999},{"date":"2022-02-02T00:00:00+0000","volume":4300145,"high":3041.855,"low":2911.6299,"close":2960.73,"open":3037.27},{"date":"2022-02-01T00:00:00+0000","volume":2166817,"high":2764,"low":2692,"close":2757.5701,"open":2756.7},{"date":"2022-01-31T00:00:00+0000","volume":1697363,"high":2716.8701,"low":2645.48,"close":2713.97,"open":2683.96},{"date":"2022-01-28T00:00:00+0000","volume":1524200,"high":2667.4099,"low":2573.8899,"close":2665.79,"open":2600},{"date":"2022-01-27T00:00:00+0000","volume":1492829,"high":2652.1987,"low":2578.8999,"close":2582.4199,"open":2627.22},{"date":"2022-01-26T00:00:00+0000","volume":1899165,"high":2655.98,"low":2543.0701,"close":2584.8,"open":2611.8501},{"date":"2022-01-25T00:00:00+0000","volume":1739298,"high":2586.77,"low":2527.5601,"close":2534.71,"open":2568.71},{"date":"2022-01-24T00:00:00+0000","volume":2377966,"high":2615.28,"low":2492.8391,"close":2607.4399,"open":2520.55},{"date":"2022-01-21T00:00:00+0000","volume":2087000,"high":2695.21,"low":2600.02,"close":2601.8401,"open":2660.24},{"date":"2022-01-20T00:00:00+0000","volume":1089036,"high":2758.24,"low":2663.28,"close":2670.1299,"open":2730.28},{"date":"2022-01-19T00:00:00+0000","volume":992088,"high":2767.99,"low":2710,"close":2713.04,"open":2738.77},{"date":"2022-01-18T00:00:00+0000","volume":1340785,"high":2747.8298,"low":2712.5601,"close":2725.8101,"open":2732},{"date":"2022-01-14T00:00:00+0000","volume":1190700,"high":2824.01,"low":2750,"close":2795.73,"open":2750},{"date":"2022-01-13T00:00:00+0000","volume":1249838,"high":2863.71,"low":2778.6101,"close":2782.6201,"open":2836.8101},{"date":"2022-01-12T00:00:00+0000","volume":1179825,"high":2856.2849,"low":2822.24,"close":2832.96,"open":2831.0901},{"date":"2022-01-11T00:00:00+0000","volume":1147178,"high":2806.5901,"low":2736.3076,"close":2800.3501,"open":2763.6101},{"date":"2022-01-10T00:00:00+0000","volume":1653081,"high":2772.8,"low":2662.8101,"close":2771.48,"open":2701.98},{"date":"2022-01-07T00:00:00+0000","volume":970100,"high":2765.095,"low":2715.78,"close":2740.0901,"open":2758.1001},{"date":"2022-01-06T00:00:00+0000","volume":1441517,"high":2793.72,"low":2735.27,"close":2751.02,"open":2749.95},{"date":"2022-01-05T00:00:00+0000","volume":2412196,"high":2885.05,"low":2750.49,"close":2753.0701,"open":2883.6201},{"date":"2022-01-04T00:00:00+0000","volume":1064104,"high":2932.2,"low":2876.3225,"close":2888.3301,"open":2911.01},{"date":"2022-01-03T00:00:00+0000","volume":1167129,"high":2911,"low":2870.0601,"close":2901.49,"open":2889.51},{"date":"2021-12-31T00:00:00+0000","volume":864400,"high":2927.3,"low":2893.55,"close":2893.5901,"open":2910.8799},{"date":"2021-12-30T00:00:00+0000","volume":646475,"high":2941.05,"low":2915.1699,"close":2920.05,"open":2929},{"date":"2021-12-29T00:00:00+0000","volume":828203,"high":2943.675,"low":2910.0901,"close":2930.0901,"open":2928.5901},{"date":"2021-12-28T00:00:00+0000","volume":904893,"high":2967.49,"low":2918.71,"close":2928.96,"open":2967.49},{"date":"2021-12-27T00:00:00+0000","volume":636400,"high":2968.53,"low":2945,"close":2961.28,"open":2949.27},{"date":"2021-12-23T00:00:00+0000","volume":686516,"high":2971.4519,"low":2939.0168,"close":2942.8501,"open":2941.79},{"date":"2021-12-22T00:00:00+0000","volume":917501,"high":2946,"low":2879.26,"close":2938.98,"open":2882},{"date":"2021-12-21T00:00:00+0000","volume":859287,"high":2893.8413,"low":2835,"close":2884.4099,"open":2863},{"date":"2021-12-20T00:00:00+0000","volume":967478,"high":2852.21,"low":2805,"close":2848.03,"open":2813.5918},{"date":"2021-12-17T00:00:00+0000","volume":2162800,"high":2889.2019,"low":2835.76,"close":2856.0601,"open":2854.29},{"date":"2021-12-16T00:00:00+0000","volume":1294813,"high":2971.03,"low":2881.8999,"close":2896.77,"open":2961.54},{"date":"2021-12-15T00:00:00+0000","volume":1263712,"high":2950.345,"low":2855.6799,"close":2947.3701,"open":2887.3201},{"date":"2021-12-14T00:00:00+0000","volume":1178623,"high":2908.8401,"low":2844.8501,"close":2899.4099,"open":2895.3999},{"date":"2021-12-13T00:00:00+0000","volume":1128908,"high":2968.8799,"low":2927.2,"close":2934.0901,"open":2968.8799},{"date":"2021-12-10T00:00:00+0000","volume":1026985,"high":2988,"low":2947.1499,"close":2973.5,"open":2982},{"date":"2021-12-09T00:00:00+0000","volume":917627,"high":2992.1001,"low":2950.5801,"close":2962.1201,"open":2963.52},{"date":"2021-12-08T00:00:00+0000","volume":864464,"high":2983.1299,"low":2944.1951,"close":2974.4099,"open":2966.6299},{"date":"2021-12-07T00:00:00+0000","volume":1161920,"high":2966,"low":2914.8501,"close":2960.73,"open":2919},{"date":"2021-12-06T00:00:00+0000","volume":1093337,"high":2886.73,"low":2812.9399,"close":2875.9299,"open":2871.48},{"date":"2021-12-03T00:00:00+0000","volume":1333800,"high":2904.26,"low":2823,"close":2850.4099,"open":2889.9099},{"date":"2021-12-02T00:00:00+0000","volume":1052051,"high":2893.5,"low":2819.6899,"close":2875.53,"open":2836.48},{"date":"2021-12-01T00:00:00+0000","volume":1356056,"high":2929.9824,"low":2830,"close":2832.3601,"open":2884.25},{"date":"2021-11-30T00:00:00+0000","volume":1808526,"high":2932.5701,"low":2841.3201,"close":2849.04,"open":2909.0049},{"date":"2021-11-29T00:00:00+0000","volume":1313568,"high":2937.24,"low":2885.97,"close":2922.28,"open":2885.97},{"date":"2021-11-26T00:00:00+0000","volume":849600,"high":2905.9399,"low":2849.71,"close":2856.1201,"open":2900.3101},{"date":"2021-11-24T00:00:00+0000","volume":823203,"high":2940,"low":2903.98,"close":2934.3501,"open":2927},{"date":"2021-11-23T00:00:00+0000","volume":906657,"high":2953.8799,"low":2897.79,"close":2935.1399,"open":2942.26},{"date":"2021-11-22T00:00:00+0000","volume":1231385,"high":3014.51,"low":2940.1101,"close":2941.5701,"open":3002.8352},{"date":"2021-11-19T00:00:00+0000","volume":988300,"high":3037,"low":2997.75,"close":2999.05,"open":3020},{"date":"2021-11-18T00:00:00+0000","volume":995710,"high":3032.2,"low":2980,"close":3014.1799,"open":2982.9199},{"date":"2021-11-17T00:00:00+0000","volume":764542,"high":2992.52,"low":2971.26,"close":2981.24,"open":2984.5801},{"date":"2021-11-16T00:00:00+0000","volume":862743,"high":2996.49,"low":2967,"close":2981.52,"open":2983.4099},{"date":"2021-11-15T00:00:00+0000","volume":812367,"high":3009.54,"low":2973.05,"close":2987.76,"open":3000},{"date":"2021-11-12T00:00:00+0000","volume":852000,"high":2997.1899,"low":2929.0801,"close":2992.9099,"open":2956.6299},{"date":"2021-11-11T00:00:00+0000","volume":612372,"high":2970,"low":2933.8999,"close":2934.96,"open":2942.1399},{"date":"2021-11-10T00:00:00+0000","volume":1135416,"high":2970.8701,"low":2906.5,"close":2932.52,"open":2960.1951},{"date":"2021-11-09T00:00:00+0000","volume":843778,"high":3007.5701,"low":2950.1399,"close":2984.97,"open":2994.9199},{"date":"2021-11-08T00:00:00+0000","volume":919407,"high":3020.6899,"low":2982.3999,"close":2987.03,"open":3000},{"date":"2021-11-05T00:00:00+0000","volume":1019700,"high":3011.415,"low":2973.04,"close":2984.8201,"open":2987.0701},{"date":"2021-11-04T00:00:00+0000","volume":1235040,"high":2997.1699,"low":2932.7,"close":2973.6599,"open":2944},{"date":"2021-11-03T00:00:00+0000","volume":894330,"high":2938.21,"low":2901.1399,"close":2935.8,"open":2925.5},{"date":"2021-11-02T00:00:00+0000","volume":1057529,"high":2938.3601,"low":2893.8201,"close":2917.26,"open":2896.1877},{"date":"2021-11-01T00:00:00+0000","volume":1613605,"high":2967.99,"low":2871.5901,"close":2875.48,"open":2963.3},{"date":"2021-10-29T00:00:00+0000","volume":1447300,"high":2972.26,"low":2903.3301,"close":2965.4099,"open":2910.3999},{"date":"2021-10-28T00:00:00+0000","volume":1620903,"high":2948.49,"low":2895.5,"close":2922.5801,"open":2945.98},{"date":"2021-10-27T00:00:00+0000","volume":2585176,"high":2982.3601,"low":2798.05,"close":2928.55,"open":2798.05},{"date":"2021-10-26T00:00:00+0000","volume":1412937,"high":2816.55,"low":2780.1101,"close":2793.4399,"open":2812.1201},{"date":"2021-10-25T00:00:00+0000","volume":1054085,"high":2784.116,"low":2736,"close":2775.46,"open":2776.21},{"date":"2021-10-22T00:00:00+0000","volume":1507600,"high":2831.1699,"low":2743.4099,"close":2772.5,"open":2807.02},{"date":"2021-10-21T00:00:00+0000","volume":742496,"high":2856.99,"low":2832.74,"close":2855.6101,"open":2843.8401},{"date":"2021-10-20T00:00:00+0000","volume":896975,"high":2884.9551,"low":2838.24,"close":2848.3,"open":2884.45},{"date":"2021-10-19T00:00:00+0000","volume":765792,"high":2882.1399,"low":2861.9199,"close":2876.4399,"open":2865.8301},{"date":"2021-10-18T00:00:00+0000","volume":783314,"high":2859.9751,"low":2824.27,"close":2859.21,"open":2824.27},{"date":"2021-10-15T00:00:00+0000","volume":1062500,"high":2844,"low":2821.29,"close":2833.5,"open":2844},{"date":"2021-10-14T00:00:00+0000","volume":1071878,"high":2833,"low":2786.78,"close":2828.24,"open":2799.04},{"date":"2021-10-13T00:00:00+0000","volume":819664,"high":2771,"low":2739.53,"close":2758,"open":2755},{"date":"2021-10-12T00:00:00+0000","volume":1106909,"high":2793.8999,"low":2725,"close":2734.26,"open":2792.75},{"date":"2021-10-11T00:00:00+0000","volume":829238,"high":2815.2725,"low":2776.1299,"close":2776.95,"open":2796},{"date":"2021-10-08T00:00:00+0000","volume":946200,"high":2806.3401,"low":2788.5869,"close":2801.1201,"open":2798.1201},{"date":"2021-10-07T00:00:00+0000","volume":900891,"high":2803.0891,"low":2771.3201,"close":2783.71,"open":2777.26},{"date":"2021-10-06T00:00:00+0000","volume":988216,"high":2757,"low":2689.9365,"close":2747.0801,"open":2692.51},{"date":"2021-10-05T00:00:00+0000","volume":1205239,"high":2747.21,"low":2680,"close":2723.54,"open":2680},{"date":"2021-10-04T00:00:00+0000","volume":1576515,"high":2714,"low":2623.3301,"close":2675.3,"open":2713.99},{"date":"2021-10-01T00:00:00+0000","volume":1418600,"high":2741.4199,"low":2667.55,"close":2729.25,"open":2671.0901},{"date":"2021-09-30T00:00:00+0000","volume":1768199,"high":2711.6101,"low":2660,"close":2665.3101,"open":2686.5},{"date":"2021-09-29T00:00:00+0000","volume":1316861,"high":2747.7451,"low":2685,"close":2690.4199,"open":2742.1899},{"date":"2021-09-28T00:00:00+0000","volume":2109483,"high":2791.4299,"low":2714,"close":2723.6799,"open":2781.77},{"date":"2021-09-27T00:00:00+0000","volume":942204,"high":2850,"low":2810,"close":2830.02,"open":2831.71},{"date":"2021-09-24T00:00:00+0000","volume":747100,"high":2858.0701,"low":2817.01,"close":2852.6599,"open":2818.9199},{"date":"2021-09-23T00:00:00+0000","volume":863805,"high":2845.0493,"low":2821.9299,"close":2836.53,"open":2832.1899},{"date":"2021-09-22T00:00:00+0000","volume":1102937,"high":2831.6699,"low":2789.76,"close":2818.77,"open":2801.01},{"date":"2021-09-21T00:00:00+0000","volume":906469,"high":2815.3401,"low":2778.45,"close":2792.9299,"open":2802.3401},{"date":"2021-09-20T00:00:00+0000","volume":1745886,"high":2787.25,"low":2741.46,"close":2780.3401,"open":2780.0034},{"date":"2021-09-17T00:00:00+0000","volume":2929500,"high":2884.99,"low":2821.23,"close":2829.27,"open":2875.97},{"date":"2021-09-16T00:00:00+0000","volume":1014942,"high":2904,"low":2869.6599,"close":2887.47,"open":2902.4199},{"date":"2021-09-15T00:00:00+0000","volume":1021942,"high":2911.6299,"low":2845.3701,"close":2904.1201,"open":2875.1799},{"date":"2021-09-14T00:00:00+0000","volume":935738,"high":2894.55,"low":2858.1101,"close":2868.1201,"open":2883.22},{"date":"2021-09-13T00:00:00+0000","volume":1008781,"high":2883,"low":2845.6499,"close":2869.3,"open":2864.02},{"date":"2021-09-10T00:00:00+0000","volume":1643500,"high":2920.3799,"low":2834.8301,"close":2838.4199,"open":2908.8701},{"date":"2021-09-09T00:00:00+0000","volume":696447,"high":2913.22,"low":2888.6799,"close":2898.27,"open":2897.6699},{"date":"2021-09-08T00:00:00+0000","volume":753027,"high":2911.02,"low":2884.46,"close":2897.6699,"open":2907.8701},{"date":"2021-09-07T00:00:00+0000","volume":758630,"high":2916.48,"low":2891.3401,"close":2910.3799,"open":2894.99},{"date":"2021-09-03T00:00:00+0000","volume":955200,"high":2907.54,"low":2870.1001,"close":2895.5,"open":2882.9199},{"date":"2021-09-02T00:00:00+0000","volume":1068143,"high":2926.5,"low":2882.1299,"close":2884.3799,"open":2918.99},{"date":"2021-09-01T00:00:00+0000","volume":791234,"high":2936.4099,"low":2912.29,"close":2916.8401,"open":2913},{"date":"2021-08-31T00:00:00+0000","volume":1337821,"high":2922.24,"low":2900,"close":2909.24,"open":2917.6899},{"date":"2021-08-30T00:00:00+0000","volume":845795,"high":2929.7898,"low":2892.51,"close":2909.3899,"open":2894.0901},{"date":"2021-08-27T00:00:00+0000","volume":1228100,"high":2900.22,"low":2840.3999,"close":2891.01,"open":2842.25},{"date":"2021-08-26T00:00:00+0000","volume":746100,"high":2862.6699,"low":2841.8301,"close":2842.46,"open":2852.3701},{"date":"2021-08-25T00:00:00+0000","volume":642153,"high":2866.26,"low":2849.1201,"close":2859,"open":2857.6599},{"date":"2021-08-24T00:00:00+0000","volume":756313,"high":2860,"low":2827.3,"close":2847.97,"open":2830.8701},{"date":"2021-08-23T00:00:00+0000","volume":1054484,"high":2843.5398,"low":2775.0984,"close":2821.99,"open":2779.97},{"date":"2021-08-20T00:00:00+0000","volume":778200,"high":2772.29,"low":2729.3401,"close":2768.74,"open":2741.6599},{"date":"2021-08-19T00:00:00+0000","volume":914796,"high":2748.925,"low":2707.1201,"close":2738.27,"open":2709.3501},{"date":"2021-08-18T00:00:00+0000","volume":746723,"high":2765.8799,"low":2728.4199,"close":2731.3999,"open":2742.3101},{"date":"2021-08-17T00:00:00+0000","volume":1063701,"high":2774.3701,"low":2736.4199,"close":2746.01,"open":2763.8201},{"date":"2021-08-16T00:00:00+0000","volume":902022,"high":2779.8101,"low":2723.3149,"close":2778.3201,"open":2760},{"date":"2021-08-13T00:00:00+0000","volume":628600,"high":2773.48,"low":2760.1001,"close":2768.1201,"open":2767.1499},{"date":"2021-08-12T00:00:00+0000","volume":732300,"high":2768.3601,"low":2735.5801,"close":2767.79,"open":2754.26},{"date":"2021-08-11T00:00:00+0000","volume":760483,"high":2776.9551,"low":2747,"close":2753.79,"open":2765.6599},{"date":"2021-08-10T00:00:00+0000","volume":770509,"high":2771.03,"low":2744.53,"close":2761.9299,"open":2761.5901},{"date":"2021-08-09T00:00:00+0000","volume":603382,"high":2766.02,"low":2728.6101,"close":2760.04,"open":2738.98},{"date":"2021-08-06T00:00:00+0000","volume":664035,"high":2741.6008,"low":2720.9299,"close":2740.72,"open":2725.8999},{"date":"2021-08-05T00:00:00+0000","volume":560002,"high":2739,"low":2712.02,"close":2738.8,"open":2720.5701},{"date":"2021-08-04T00:00:00+0000","volume":673504,"high":2729.98,"low":2708.46,"close":2720.5701,"open":2724.99},{"date":"2021-08-03T00:00:00+0000","volume":952248,"high":2726.71,"low":2684,"close":2725.6001,"open":2720},{"date":"2021-08-02T00:00:00+0000","volume":818242,"high":2720.4099,"low":2693.3899,"close":2719.79,"open":2709.6899},{"date":"2021-07-30T00:00:00+0000","volume":1094549,"high":2715.4272,"low":2696.2839,"close":2704.4199,"open":2710.22},{"date":"2021-07-29T00:00:00+0000","volume":915096,"high":2743.03,"low":2722.76,"close":2730.8101,"open":2727.6121},{"date":"2021-07-28T00:00:00+0000","volume":2720184,"high":2793.52,"low":2727,"close":2727.6299,"open":2771.24},{"date":"2021-07-27T00:00:00+0000","volume":2038631,"high":2800.22,"low":2702.1101,"close":2735.9299,"open":2800.22},{"date":"2021-07-26T00:00:00+0000","volume":1098061,"high":2794.26,"low":2753.49,"close":2792.8899,"open":2765},{"date":"2021-07-23T00:00:00+0000","volume":1304403,"high":2776.1699,"low":2694.01,"close":2756.3201,"open":2705.2},{"date":"2021-07-22T00:00:00+0000","volume":661276,"high":2670.0901,"low":2648,"close":2666.5701,"open":2653},{"date":"2021-07-21T00:00:00+0000","volume":696134,"high":2652.345,"low":2612.03,"close":2652.01,"open":2615.74},{"date":"2021-07-20T00:00:00+0000","volume":874392,"high":2640.0271,"low":2583.7676,"close":2622.03,"open":2600.0801},{"date":"2021-07-19T00:00:00+0000","volume":1159678,"high":2624.9399,"low":2570.74,"close":2585.0801,"open":2623.1101},{"date":"2021-07-16T00:00:00+0000","volume":701533,"high":2643.6599,"low":2617.1257,"close":2636.9099,"open":2632.8201},{"date":"2021-07-15T00:00:00+0000","volume":790534,"high":2651.8999,"low":2612.3999,"close":2625.3301,"open":2650},{"date":"2021-07-14T00:00:00+0000","volume":882799,"high":2659.8899,"low":2637.96,"close":2641.6499,"open":2638.03},{"date":"2021-07-13T00:00:00+0000","volume":814557,"high":2640.8398,"low":2612.74,"close":2619.8899,"open":2617.6299},{"date":"2021-07-12T00:00:00+0000","volume":736910,"high":2615.3999,"low":2592,"close":2611.28,"open":2596.6699},{"date":"2021-07-09T00:00:00+0000","volume":755300,"high":2596.99,"low":2578.8701,"close":2591.49,"open":2578.8899},{"date":"2021-07-08T00:00:00+0000","volume":975461,"high":2600.6499,"low":2560.8,"close":2583.54,"open":2565},{"date":"2021-07-07T00:00:00+0000","volume":788351,"high":2612.7983,"low":2595.2,"close":2601.55,"open":2606.8201},{"date":"2021-07-06T00:00:00+0000","volume":1067517,"high":2597.6899,"low":2568.1799,"close":2595.4199,"open":2588.99},{"date":"2021-07-02T00:00:00+0000","volume":1058000,"high":2576.96,"low":2535.3799,"close":2574.3799,"open":2536.79},{"date":"2021-07-01T00:00:00+0000","volume":823301,"high":2529.25,"low":2496.9951,"close":2527.3701,"open":2496.9951},{"date":"2021-06-30T00:00:00+0000","volume":1200478,"high":2516,"low":2495.1499,"close":2506.3201,"open":2513.0713},{"date":"2021-06-29T00:00:00+0000","volume":945856,"high":2540,"low":2508.75,"close":2520.3701,"open":2535.45},{"date":"2021-06-28T00:00:00+0000","volume":1368412,"high":2546.74,"low":2519.4756,"close":2536.3899,"open":2540},{"date":"2021-06-25T00:00:00+0000","volume":1674200,"high":2550.1001,"low":2528.8799,"close":2539.8999,"open":2539.1399},{"date":"2021-06-24T00:00:00+0000","volume":887493,"high":2550.6899,"low":2539.73,"close":2545.6399,"open":2541.0701},{"date":"2021-06-23T00:00:00+0000","volume":942191,"high":2555.52,"low":2525.04,"close":2529.23,"open":2531},{"date":"2021-06-22T00:00:00+0000","volume":1017499,"high":2545.3999,"low":2520.53,"close":2539.99,"open":2529},{"date":"2021-06-21T00:00:00+0000","volume":1269924,"high":2540.7349,"low":2502.6851,"close":2529.1001,"open":2514.8},{"date":"2021-06-18T00:00:00+0000","volume":2665310,"high":2525,"low":2492.1001,"close":2511.3501,"open":2514.1101},{"date":"2021-06-17T00:00:00+0000","volume":1287791,"high":2543.77,"low":2510.3,"close":2527.4199,"open":2510.46},{"date":"2021-06-16T00:00:00+0000","volume":1315838,"high":2530.47,"low":2482.9995,"close":2513.9299,"open":2524.95},{"date":"2021-06-15T00:00:00+0000","volume":1107822,"high":2537.24,"low":2512.97,"close":2520.6599,"open":2530.4399},{"date":"2021-06-14T00:00:00+0000","volume":1127522,"high":2528.23,"low":2500.9399,"close":2527.04,"open":2513.3899},{"date":"2021-06-11T00:00:00+0000","volume":1262309,"high":2526.99,"low":2498.5,"close":2513.9299,"open":2524.9199},{"date":"2021-06-10T00:00:00+0000","volume":1561733,"high":2523.26,"low":2494.01,"close":2521.6001,"open":2494.01},{"date":"2021-06-09T00:00:00+0000","volume":1006337,"high":2505,"low":2487.3301,"close":2491.3999,"open":2499.5},{"date":"2021-06-08T00:00:00+0000","volume":1253253,"high":2494.4951,"low":2468.24,"close":2482.8501,"open":2479.8999},{"date":"2021-06-07T00:00:00+0000","volume":1192453,"high":2467.97,"low":2441.0725,"close":2466.0901,"open":2451.3201},{"date":"2021-06-04T00:00:00+0000","volume":1297434,"high":2453.8589,"low":2417.77,"close":2451.76,"open":2422.52},{"date":"2021-06-03T00:00:00+0000","volume":917291,"high":2409.7451,"low":2382.8301,"close":2404.6101,"open":2395.02},{"date":"2021-06-02T00:00:00+0000","volume":850390,"high":2442,"low":2404.2,"close":2421.28,"open":2435.3101},{"date":"2021-06-01T00:00:00+0000","volume":958289,"high":2437.9709,"low":2405.45,"close":2429.8101,"open":2422},{"date":"2021-05-28T00:00:00+0000","volume":1205382,"high":2428.1399,"low":2407.6899,"close":2411.5601,"open":2421.96},{"date":"2021-05-27T00:00:00+0000","volume":1948113,"high":2440,"low":2402,"close":2402.51,"open":2436.9399},{"date":"2021-05-26T00:00:00+0000","volume":1092819,"high":2442.9441,"low":2412.52,"close":2433.53,"open":2412.8301},{"date":"2021-05-25T00:00:00+0000","volume":941928,"high":2432.8899,"low":2402.99,"close":2409.0701,"open":2420},{"date":"2021-05-24T00:00:00+0000","volume":1062189,"high":2418.48,"low":2360.1101,"close":2406.6699,"open":2367},{"date":"2021-05-21T00:00:00+0000","volume":1141632,"high":2367.6951,"low":2342.3701,"close":2345.1001,"open":2365.99},{"date":"2021-05-20T00:00:00+0000","volume":1191593,"high":2360.3401,"low":2321.0901,"close":2356.0901,"open":2328.04},{"date":"2021-05-19T00:00:00+0000","volume":967544,"high":2316.76,"low":2263.52,"close":2308.71,"open":2264.3999},{"date":"2021-05-18T00:00:00+0000","volume":865119,"high":2343.1499,"low":2303.1599,"close":2303.4299,"open":2336.9099},{"date":"2021-05-17T00:00:00+0000","volume":941079,"high":2323.29,"low":2295.5,"close":2321.4099,"open":2309.3201},{"date":"2021-05-14T00:00:00+0000","volume":1294331,"high":2321.1399,"low":2283.5266,"close":2316.1599,"open":2291.8301},{"date":"2021-05-13T00:00:00+0000","volume":1333508,"high":2276.6013,"low":2242.72,"close":2261.97,"open":2261.0901},{"date":"2021-05-12T00:00:00+0000","volume":1746664,"high":2285.3701,"low":2230.05,"close":2239.0801,"open":2261.71},{"date":"2021-05-11T00:00:00+0000","volume":1551035,"high":2322,"low":2283,"close":2308.76,"open":2291.8601},{"date":"2021-05-10T00:00:00+0000","volume":1272348,"high":2378,"low":2334.73,"close":2341.6599,"open":2374.8899},{"date":"2021-05-07T00:00:00+0000","volume":1163600,"high":2416.4099,"low":2390,"close":2398.6899,"open":2400},{"date":"2021-05-06T00:00:00+0000","volume":978908,"high":2382.71,"low":2342.3381,"close":2381.3501,"open":2350.6399},{"date":"2021-05-05T00:00:00+0000","volume":1090275,"high":2382.2,"low":2351.885,"close":2356.74,"open":2368.4199},{"date":"2021-05-04T00:00:00+0000","volume":1686545,"high":2379.26,"low":2311.7,"close":2354.25,"open":2369.74},{"date":"2021-05-03T00:00:00+0000","volume":1648353,"high":2419.7,"low":2384.5,"close":2395.1699,"open":2402.72},{"date":"2021-04-30T00:00:00+0000","volume":1956700,"high":2427.1399,"low":2402.1599,"close":2410.1201,"open":2404.49},{"date":"2021-04-29T00:00:00+0000","volume":1901962,"high":2436.0327,"low":2402.28,"close":2429.8899,"open":2410.3301},{"date":"2021-04-28T00:00:00+0000","volume":2933739,"high":2451.6599,"low":2374.8501,"close":2379.9099,"open":2407.145},{"date":"2021-04-27T00:00:00+0000","volume":1281426,"high":2337.45,"low":2304.408,"close":2307.1201,"open":2336},{"date":"2021-04-26T00:00:00+0000","volume":1016956,"high":2341.26,"low":2313.8401,"close":2326.74,"open":2319.9299},{"date":"2021-04-23T00:00:00+0000","volume":1433500,"high":2325.8201,"low":2278.21,"close":2315.3,"open":2283.47},{"date":"2021-04-22T00:00:00+0000","volume":967242,"high":2303.7622,"low":2256.45,"close":2267.9199,"open":2293.23},{"date":"2021-04-21T00:00:00+0000","volume":1010346,"high":2295.3201,"low":2258.5701,"close":2293.29,"open":2285.25},{"date":"2021-04-20T00:00:00+0000","volume":1088749,"high":2309.175,"low":2271.7251,"close":2293.6299,"open":2307.8899},{"date":"2021-04-19T00:00:00+0000","volume":1234545,"high":2318.45,"low":2287.845,"close":2303.49,"open":2291.98},{"date":"2021-04-16T00:00:00+0000","volume":1130090,"high":2306.4399,"low":2284.45,"close":2297.76,"open":2303},{"date":"2021-04-15T00:00:00+0000","volume":1155783,"high":2306.5964,"low":2266,"close":2296.6599,"open":2276.98},{"date":"2021-04-14T00:00:00+0000","volume":1010967,"high":2277.99,"low":2249.2827,"close":2254.8401,"open":2275.1599},{"date":"2021-04-13T00:00:00+0000","volume":1165804,"high":2277.1399,"low":2256.0901,"close":2267.27,"open":2261.47},{"date":"2021-04-12T00:00:00+0000","volume":1513917,"high":2274.7898,"low":2238.4651,"close":2254.79,"open":2266.25},{"date":"2021-04-09T00:00:00+0000","volume":1044365,"high":2289.04,"low":2253.7139,"close":2285.88,"open":2256.7},{"date":"2021-04-08T00:00:00+0000","volume":1324667,"high":2284.0049,"low":2257.6799,"close":2265.4399,"open":2277.96},{"date":"2021-04-07T00:00:00+0000","volume":1116116,"high":2255,"low":2225.3303,"close":2249.68,"open":2226.13},{"date":"2021-04-06T00:00:00+0000","volume":1263329,"high":2237.51,"low":2214.9199,"close":2224.75,"open":2222.5},{"date":"2021-04-05T00:00:00+0000","volume":2099235,"high":2237.3101,"low":2151.6201,"close":2225.55,"open":2152.9399},{"date":"2021-04-01T00:00:00+0000","volume":1698978,"high":2142.94,"low":2096.89,"close":2137.75,"open":2097.95},{"date":"2021-03-31T00:00:00+0000","volume":1351047,"high":2093.3274,"low":2056.7451,"close":2068.6299,"open":2059.1201},{"date":"2021-03-30T00:00:00+0000","volume":965519,"high":2070.78,"low":2045,"close":2055.54,"open":2057.6299},{"date":"2021-03-29T00:00:00+0000","volume":1110485,"high":2058.4299,"low":2015.62,"close":2055.95,"open":2027.88},{"date":"2021-03-26T00:00:00+0000","volume":1493800,"high":2050.99,"low":2014.0201,"close":2035.55,"open":2038.86},{"date":"2021-03-25T00:00:00+0000","volume":1394194,"high":2058.71,"low":2010.73,"close":2044.36,"open":2044.8101},{"date":"2021-03-24T00:00:00+0000","volume":1101651,"high":2078.21,"low":2041.5551,"close":2045.0601,"open":2065.3701},{"date":"2021-03-23T00:00:00+0000","volume":1169350,"high":2072.3025,"low":2039.35,"close":2052.96,"open":2051.7},{"date":"2021-03-22T00:00:00+0000","volume":1832200,"high":2057.99,"low":2026.0699,"close":2038.59,"open":2041.84},{"date":"2021-03-19T00:00:00+0000","volume":2314400,"high":2053.1,"low":2017.68,"close":2043.2,"open":2042.05},{"date":"2021-03-18T00:00:00+0000","volume":1310937,"high":2075.5,"low":2033.55,"close":2036.22,"open":2061},{"date":"2021-03-17T00:00:00+0000","volume":1267755,"high":2109.78,"low":2054.1201,"close":2091.0801,"open":2076.03},{"date":"2021-03-16T00:00:00+0000","volume":1440446,"high":2123.5601,"low":2070.28,"close":2092.52,"open":2078.99},{"date":"2021-03-15T00:00:00+0000","volume":1197725,"high":2067.0601,"low":2043.8123,"close":2066.49,"open":2062.3},{"date":"2021-03-12T00:00:00+0000","volume":1725000,"high":2090.26,"low":2047.55,"close":2061.9199,"open":2085},{"date":"2021-03-11T00:00:00+0000","volume":1238300,"high":2125.7,"low":2072.3799,"close":2114.77,"open":2074.0601},{"date":"2021-03-10T00:00:00+0000","volume":1267800,"high":2075,"low":2033.37,"close":2055.03,"open":2071.76},{"date":"2021-03-09T00:00:00+0000","volume":1696400,"high":2078.04,"low":2047.83,"close":2052.7,"open":2070},{"date":"2021-03-08T00:00:00+0000","volume":1646000,"high":2128.8101,"low":2021.61,"close":2024.17,"open":2101.1299},{"date":"2021-03-05T00:00:00+0000","volume":2193800,"high":2118.11,"low":2046.415,"close":2108.54,"open":2073.1201},{"date":"2021-03-04T00:00:00+0000","volume":2085128,"high":2089.24,"low":2020.27,"close":2049.0901,"open":2023.37},{"date":"2021-03-03T00:00:00+0000","volume":1403150,"high":2088.5181,"low":2010,"close":2026.71,"open":2067.21},{"date":"2021-03-02T00:00:00+0000","volume":999607,"high":2104.3701,"low":2071.26,"close":2075.8401,"open":2076.1899},{"date":"2021-03-01T00:00:00+0000","volume":1382983,"high":2086.52,"low":2046.1,"close":2081.51,"open":2056.52},{"date":"2021-02-26T00:00:00+0000","volume":2083500,"high":2071.0099,"low":2016.06,"close":2036.86,"open":2050.52},{"date":"2021-02-25T00:00:00+0000","volume":1713513,"high":2094.8799,"low":2021.29,"close":2031.36,"open":2067.45},{"date":"2021-02-24T00:00:00+0000","volume":1185327,"high":2100.78,"low":2038.13,"close":2095.1699,"open":2041.83},{"date":"2021-02-23T00:00:00+0000","volume":1621538,"high":2082.01,"low":2002.02,"close":2070.8601,"open":2025.01},{"date":"2021-02-22T00:00:00+0000","volume":1311581,"high":2091.4199,"low":2062.1399,"close":2064.8799,"open":2067},{"date":"2021-02-19T00:00:00+0000","volume":1457612,"high":2130.53,"low":2097.41,"close":2101.14,"open":2119.27},{"date":"2021-02-18T00:00:00+0000","volume":1121855,"high":2132.735,"low":2103.71,"close":2117.2,"open":2110.39},{"date":"2021-02-17T00:00:00+0000","volume":1020252,"high":2133.66,"low":2098.92,"close":2128.31,"open":2100},{"date":"2021-02-16T00:00:00+0000","volume":1133838,"high":2152.68,"low":2104.36,"close":2121.9,"open":2104.36},{"date":"2021-02-12T00:00:00+0000","volume":855865,"high":2108.82,"low":2083.13,"close":2104.11,"open":2090.25},{"date":"2021-02-11T00:00:00+0000","volume":945650,"high":2102.03,"low":2077.32,"close":2095.89,"open":2099.51}]`
dynamicImg = "https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Google_2015_logo.svg/1200px-Google_2015_logo.svg.png"



/* stock_address='100 Winchester Cir, Los Gatos, California, United States'
stock_description='Netflix, Inc. is an American subscription streaming service and production company. Launched on August 29, 1997, it offers a library of films and television series through distribution deals as well as its own productions, known as Netflix Originals.' */
stock_name = ""
stock_address = 'Via Nino Tavoni, 12/3, 41058 Vignola MO'
stock_description = 'Questo progetto è stato reso possibile da: Ospedale psichiatrico Il Gelso.'

/* var upward = "rgb(17,149,8)"
var downward = "rgb(202, 29, 33)" */
firstDate = ""
lastDate = ""
earnedInTimePeriod = 0
    /**
     * The main function, gets called when the page is loaded.
     */
function STDs() {

    /* st = GetURLParameter("st")
    st = st.replaceAll("%22", '"') */
    st = JSON.parse(st)

    st = st.reverse()

    date = new Date(st[0].date)
    firstDate = `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDay()}`
    date = new Date(st[st.length - 1].date)
    lastDate = `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDay()}`

    earnedInTimePeriod = (st[st.length - 1].close - st[0].close).toFixed(2)

    console.log(st)

    mainInfo()
    mainChart()
    theOtherChart()
}

/**
 * Puts together a string to put in the top moving text (revoked).
 * @param string string to add.
 */
function marqData(string) {
    marqDa = document.getElementById("marqData")

    if (marqDa.innerHTML != "") {
        marqDa.innerHTML += " · "
    }
    marqDa.innerHTML += string
}

/**
 * Modifies the main text elements in the HTML to insert the main data (non calculated).
 */
function mainInfo() {
    stock_name = st[st.length - 1].symbol
    document.getElementById("title").innerHTML = stock_name
    document.getElementById("exchange").innerHTML = st[st.length - 1].exchange
    document.getElementById("address").innerHTML = stock_address
    document.getElementById("description").innerHTML = stock_description
    marqData(`Last close: ${(st[st.length - 1].close).toFixed(2)}$`)

    document.getElementById("maxHypo").innerHTML = `Max theoric realizable: ${maxHypotheticalHighAndSellRevenue()}$.`


    if (earnedInTimePeriod >= 0) {
        document.getElementById("earned").innerHTML = `In the time span the company has earned: ${earnedInTimePeriod}$.`
    } else document.getElementById("earned").innerHTML = `In the time span the company has lost: ${-earnedInTimePeriod}$.`

    document.getElementById("raiseDays").innerHTML = `The stock has risen ${raiseDaysPercentage()}% of the days in the time span.`

    document.getElementById("immagine").src = dynamicImg
}

/**
 * Calculates the maximum hypotetical income from selling at highest and buying at lowest everyday.
 * @returns The calculated value.
 */
function maxHypotheticalHighAndSellRevenue() {
    sum = 0;
    for (let i = 0; i < st.length; i++) {
        sum += st[i].high - st[i].low
    }
    return sum.toFixed(2)
}

/**
 * Calculates the percentage of days the stock went up.
 * @returns The percentage.
 */
function raiseDaysPercentage() {
    daysPassed = 0
    daysRaised = 0
    yesterday = st[0].close
    for (let i = 1; i < st.length; i++) {
        today = st[i].close
        if (today > yesterday) {
            daysRaised += 1
        }
        daysPassed += 1
        yesterday = today
    }
    return ((daysRaised / daysPassed) * 100).toFixed(3)
}

/**
 * Puts together the main chart.
 */
function mainChart() {
    const ctx = document.getElementById('main-chart')

    closes = []
    opens = []
    highs = []
    lows = []
    labels = []
    max = st[0].close
    min = st[0].close

    for (let i = 0; i < st.length; i++) {
        if (max < st[i].close) max = st[i].close
        if (min > st[i].close) min = st[i].close
        closes[i] = st[i].close
        opens[i] = st[i].open
        highs[i] = st[i].high
        lows[i] = st[i].low
        date = new Date(st[i].date)
        labels[i] = `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}`
    }
    marqData(`MAX in time: ${max.toFixed(2)}$`)
    marqData(`MIN in time: ${min.toFixed(2)}$`)

    const myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                label: 'Close',
                data: closes,
                fill: false,
                borderColor: 'rgb(75, 192, 192)',
                tension: 0.1
            }, {
                label: 'Open',
                data: opens,
                fill: false,
                borderColor: 'rgb(95, 70, 192)',
                tension: 0.1
            }, {
                label: 'High',
                data: highs,
                fill: false,
                borderColor: 'rgb(14, 205, 14)',
                tension: 0.1
            }, {
                label: 'Low',
                data: lows,
                fill: false,
                borderColor: 'rgb(220, 40, 70)',
                tension: 0.1
            }]
        },
        options: {
            scales: {
                x: {
                    ticks: {
                        color: 'whitesmoke'
                    }
                },
                y: {
                    ticks: {
                        color: 'whitesmoke'
                    }
                }
            },
            plugins: {
                legend: {
                    labels: {
                        color: 'whitesmoke'
                    }
                }
            }
        }
    })
}

/**
 * Puts together the secondary chart.
 */
function theOtherChart() {
    const ctx = document.getElementById('the-other-chart')
    labels = []
    data = []
    MCVs = []

    MCVs[0] = new MCV(st[0].close, 1)

    for (let i = 1; i < st.length; i++) {
        done = false
        for (let j = 0; j < MCVs.length; j++) {
            if (MCVs[j].value == st[i].close && !done) {
                MCVs[j].repetitions += 1;
                done = true
            }

            if (j == MCVs.length - 1 && !done) {
                MCVs[MCVs.length] = new MCV(st[i].close, 0)
            }
        }

    }

    for (let i = 0; i < MCVs.length; i++) {
        data[i] = MCVs[i].repetitions
        labels[i] = MCVs[i].value
    }

    console.log(MCVs)

    const myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Most Common Values',
                data: data,
                fill: false,
                backgroundColor: 'rgb(75, 192, 192)',
                borderColor: 'rgb(55, 172, 172)',
                borderWidth: 2,
                tension: 0.1
            }]
        },
        options: {
            scales: {
                x: {
                    ticks: {
                        color: 'whitesmoke'
                    }
                },
                y: {
                    ticks: {
                        color: 'whitesmoke'
                    }
                }
            },
            plugins: {
                legend: {
                    labels: {
                        color: 'whitesmoke'
                    }
                }
            }
        }
    })
}

/**
 * A class to make the counting of Most Common Values easier.
 */
class MCV {
    /**
     * 
     * @param value A value.
     * @param repetitions The number of times it occured.
     */
    constructor(value, repetitions) {
        this.value = value
        this.repetitions = repetitions
    }
}

/**
 * Saves a chart as image on client's device.
 * @param main If it has to refer to the main chart.
 */
function saveAsImage(main) {
    link = document.createElement('a')
    if (main) {
        link.download = `${stock_name} from ${firstDate} to ${lastDate}.png`
        chart = document.getElementById('main-chart')
    } else {
        link.download = `MCV in ${stock_name} from ${firstDate} to ${lastDate}.png`
        chart = document.getElementById('the-other-chart')
    }
    link.href = chart.toDataURL()
    link.click()
    link.delete
}

/**
 * Gets an URL param.
 * @param sParam The URL param name.
 * @returns The param.
 */
function GetURLParameter(sParam) {
    var sPageURL = window.location.search.substring(1)
    var sURLVariables = sPageURL.split('&')
    for (var i = 0; i < sURLVariables.length; i++) {
        var sParameterName = sURLVariables[i].split('=')
        if (sParameterName[0] == sParam) {
            return sParameterName[1]
        }
    }
}
